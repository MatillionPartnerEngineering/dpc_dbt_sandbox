type: "transformation"
version: "1.0"
pipeline:
  components:
    REDCARDS_SEMISTRUCTURED:
      type: "table-input"
      parameters:
        componentName: "REDCARDS_SEMISTRUCTURED"
        database: "[Environment Default]"
        schema: "[Environment Default]"
        targetTable: "REDCARDS_SEMISTRUCTURED"
        columnNames:
        - "DATA_VALUE"
        timeOffset:
    Flatten MANCHESTERUNITED_SEMI:
      type: "extract-nested-data-sf"
      sources:
      - "REDCARDS_SEMISTRUCTURED"
      parameters:
        componentName: "Flatten MANCHESTERUNITED_SEMI"
        includeInputColumns: "No"
        columns:
        - name: "results"
          datatype: "NUMBER"
          size: "0"
          decimalPlaces: "0"
          columnName: "DATA_VALUE"
          aliasName: "results"
          isArray: "false"
          include: "false"
        - name: "paging"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "DATA_VALUE"
          aliasName: "paging"
          isArray: "false"
          include: "false"
          childElements:
          - name: "total"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "DATA_VALUE"
            aliasName: "paging_total"
            isArray: "false"
            include: "false"
          - name: "current"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "DATA_VALUE"
            aliasName: "current"
            isArray: "false"
            include: "false"
        - name: "parameters"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "DATA_VALUE"
          aliasName: "parameters"
          isArray: "false"
          include: "false"
          childElements:
          - name: "team"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "DATA_VALUE"
            aliasName: "parameters_team"
            isArray: "false"
            include: "false"
          - name: "season"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "DATA_VALUE"
            aliasName: "parameters_season"
            isArray: "false"
            include: "false"
        - name: "errors"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "DATA_VALUE"
          aliasName: "errors"
          isArray: "false"
          include: "false"
        - name: "get"
          datatype: "VARCHAR"
          size: "0"
          decimalPlaces: "0"
          columnName: "DATA_VALUE"
          aliasName: "get"
          isArray: "false"
          include: "false"
        - name: "response"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "DATA_VALUE"
          aliasName: "response"
          isArray: "true"
          include: "false"
          childElements:
          - name: "response-element"
            datatype: "VARIANT"
            size: "0"
            decimalPlaces: "0"
            columnName: "DATA_VALUE"
            aliasName: "response-element"
            isArray: "false"
            include: "false"
            childElements:
            - name: "player"
              datatype: "VARIANT"
              size: "0"
              decimalPlaces: "0"
              columnName: "DATA_VALUE"
              aliasName: "player"
              isArray: "false"
              include: "false"
              childElements:
              - name: "height"
                datatype: "VARIANT"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "response-element_player_height"
                isArray: "false"
                include: "false"
              - name: "age"
                datatype: "NUMBER"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "age"
                isArray: "false"
                include: "false"
              - name: "lastname"
                datatype: "VARCHAR"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "lastname"
                isArray: "false"
                include: "false"
              - name: "nationality"
                datatype: "VARCHAR"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "nationality"
                isArray: "false"
                include: "true"
              - name: "id"
                datatype: "NUMBER"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "response-element_player_id"
                isArray: "false"
                include: "false"
              - name: "birth"
                datatype: "VARIANT"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "birth"
                isArray: "false"
                include: "false"
                childElements:
                - name: "place"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "response-element_player_birth_place"
                  isArray: "false"
                  include: "false"
                - name: "country"
                  datatype: "VARCHAR"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "response-element_player_birth_country"
                  isArray: "false"
                  include: "false"
                - name: "date"
                  datatype: "VARCHAR"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "date"
                  isArray: "false"
                  include: "false"
              - name: "name"
                datatype: "VARCHAR"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "response-element_player_name"
                isArray: "false"
                include: "true"
              - name: "injured"
                datatype: "BOOLEAN"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "injured"
                isArray: "false"
                include: "false"
              - name: "firstname"
                datatype: "VARCHAR"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "firstname"
                isArray: "false"
                include: "false"
              - name: "weight"
                datatype: "VARIANT"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "response-element_player_weight"
                isArray: "false"
                include: "false"
              - name: "photo"
                datatype: "VARCHAR"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "photo"
                isArray: "false"
                include: "false"
            - name: "statistics"
              datatype: "VARIANT"
              size: "0"
              decimalPlaces: "0"
              columnName: "DATA_VALUE"
              aliasName: "statistics"
              isArray: "true"
              include: "false"
              childElements:
              - name: "statistics-element"
                datatype: "VARIANT"
                size: "0"
                decimalPlaces: "0"
                columnName: "DATA_VALUE"
                aliasName: "statistics-element"
                isArray: "false"
                include: "false"
                childElements:
                - name: "team"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "response-element_statistics-element_team"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "name"
                    datatype: "VARCHAR"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_team_name"
                    isArray: "false"
                    include: "true"
                  - name: "id"
                    datatype: "NUMBER"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_team_id"
                    isArray: "false"
                    include: "false"
                  - name: "logo"
                    datatype: "VARCHAR"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_team_logo"
                    isArray: "false"
                    include: "false"
                - name: "dribbles"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "dribbles"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "past"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "past"
                    isArray: "false"
                    include: "false"
                  - name: "attempts"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_dribbles_attempts"
                    isArray: "false"
                    include: "false"
                  - name: "success"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_dribbles_success"
                    isArray: "false"
                    include: "false"
                - name: "penalty"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "penalty"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "scored"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_penalty_scored"
                    isArray: "false"
                    include: "false"
                  - name: "commited"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "commited"
                    isArray: "false"
                    include: "false"
                  - name: "missed"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_penalty_missed"
                    isArray: "false"
                    include: "false"
                  - name: "saved"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_penalty_saved"
                    isArray: "false"
                    include: "false"
                  - name: "won"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_penalty_won"
                    isArray: "false"
                    include: "false"
                - name: "shots"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "shots"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "on"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_shots_on"
                    isArray: "false"
                    include: "true"
                  - name: "total"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_shots_total"
                    isArray: "false"
                    include: "true"
                - name: "duels"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "duels"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "total"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_duels_total"
                    isArray: "false"
                    include: "false"
                  - name: "won"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_duels_won"
                    isArray: "false"
                    include: "false"
                - name: "tackles"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "tackles"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "total"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_tackles_total"
                    isArray: "false"
                    include: "false"
                  - name: "interceptions"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_tackles_interceptions"
                    isArray: "false"
                    include: "false"
                  - name: "blocks"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_tackles_blocks"
                    isArray: "false"
                    include: "false"
                - name: "games"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "games"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "captain"
                    datatype: "BOOLEAN"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "captain"
                    isArray: "false"
                    include: "false"
                  - name: "appearences"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_games_appearences"
                    isArray: "false"
                    include: "false"
                  - name: "number"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "number"
                    isArray: "false"
                    include: "false"
                  - name: "rating"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_games_rating"
                    isArray: "false"
                    include: "false"
                  - name: "minutes"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_games_minutes"
                    isArray: "false"
                    include: "false"
                  - name: "position"
                    datatype: "VARCHAR"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "position"
                    isArray: "false"
                    include: "false"
                  - name: "lineups"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_games_lineups"
                    isArray: "false"
                    include: "false"
                - name: "fouls"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "fouls"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "committed"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_fouls_committed"
                    isArray: "false"
                    include: "true"
                  - name: "drawn"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_fouls_drawn"
                    isArray: "false"
                    include: "true"
                - name: "goals"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "goals"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "saves"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_goals_saves"
                    isArray: "false"
                    include: "false"
                  - name: "conceded"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_goals_conceded"
                    isArray: "false"
                    include: "false"
                  - name: "assists"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_goals_assists"
                    isArray: "false"
                    include: "true"
                  - name: "total"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_goals_total"
                    isArray: "false"
                    include: "true"
                - name: "league"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "league"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "country"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_league_country"
                    isArray: "false"
                    include: "false"
                  - name: "name"
                    datatype: "VARCHAR"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_league_name"
                    isArray: "false"
                    include: "false"
                  - name: "flag"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_league_flag"
                    isArray: "false"
                    include: "false"
                  - name: "id"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_league_id"
                    isArray: "false"
                    include: "false"
                  - name: "season"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_league_season"
                    isArray: "false"
                    include: "false"
                  - name: "logo"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_league_logo"
                    isArray: "false"
                    include: "false"
                - name: "cards"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "cards"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "red"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_cards_red"
                    isArray: "false"
                    include: "true"
                  - name: "yellowred"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_cards_yellowred"
                    isArray: "false"
                    include: "false"
                  - name: "yellow"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_cards_yellow"
                    isArray: "false"
                    include: "true"
                - name: "substitutes"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "substitutes"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "bench"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_substitutes_bench"
                    isArray: "false"
                    include: "false"
                  - name: "in"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_substitutes_in"
                    isArray: "false"
                    include: "false"
                  - name: "out"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_substitutes_out"
                    isArray: "false"
                    include: "false"
                - name: "passes"
                  datatype: "VARIANT"
                  size: "0"
                  decimalPlaces: "0"
                  columnName: "DATA_VALUE"
                  aliasName: "passes"
                  isArray: "false"
                  include: "false"
                  childElements:
                  - name: "accuracy"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_passes_accuracy"
                    isArray: "false"
                    include: "false"
                  - name: "key"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_passes_key"
                    isArray: "false"
                    include: "false"
                  - name: "total"
                    datatype: "VARIANT"
                    size: "0"
                    decimalPlaces: "0"
                    columnName: "DATA_VALUE"
                    aliasName: "response-element_statistics-element_passes_total"
                    isArray: "false"
                    include: "false"
        outerJoin: "No"
        inputAlias: "i"
        arrayPrefix: "f"
        castingMethod: "Fail on invalid data"
        caseColumnAliasNames: "No"
    Yesterday's Date:
      type: "fixed-flow"
      parameters:
        componentName: "Yesterday's Date"
        columns:
        - - "DATE"
          - "TIMESTAMP"
          - ""
          - ""
        values:
        - - "${proj_yest_date}"
    Apply Data Freshness:
      type: "join"
      sources:
      - "Flatten MANCHESTERUNITED_SEMI"
      - "Yesterday's Date"
      parameters:
        componentName: "Apply Data Freshness"
        mainTable: "Flatten MANCHESTERUNITED_SEMI"
        mainTableAlias: "nested"
        joins:
        - - "Yesterday's Date"
          - "date"
          - "Full"
        joinExpressions:
        - - "\"nested\".\"response-element_player_name\" = \"nested\".\"response-element_player_name\""
          - "nested_Full_date"
        columnMappings:
        - - "date.DATE"
          - "LASTUPDATED"
        - - "nested.nationality"
          - "NATIONALITY"
        - - "nested.response-element_player_name"
          - "PLAYERNAME"
        - - "nested.response-element_statistics-element_team_name"
          - "TEAMNAME"
        - - "nested.response-element_statistics-element_shots_on"
          - "SHOTS_ONGOAL"
        - - "nested.response-element_statistics-element_shots_total"
          - "SHOTS_TOTAL"
        - - "nested.response-element_statistics-element_fouls_committed"
          - "FOULS_COMMITTED"
        - - "nested.response-element_statistics-element_fouls_drawn"
          - "FOULS_DRAWN"
        - - "nested.response-element_statistics-element_goals_assists"
          - "GOALS_ASSISTS"
        - - "nested.response-element_statistics-element_goals_total"
          - "GOALS_TOTAL"
        - - "nested.response-element_statistics-element_cards_red"
          - "RED"
        - - "nested.response-element_statistics-element_cards_yellow"
          - "YELLOW"
    Write to REDCARDS_STRUCTURED:
      type: "rewrite-table"
      sources:
      - "Apply Data Freshness"
      parameters:
        componentName: "Write to REDCARDS_STRUCTURED"
        warehouse: "[Environment Default]"
        database: "[Environment Default]"
        schema: "[Environment Default]"
        targetTable: "REDCARDS_STRUCTURED"
        orderBy:
  variables:
    xform_yestdate:
      metadata:
        type: "TEXT"
        description: ""
        scope: "COPIED"
        visibility: "PUBLIC"
      defaultValue: "1900-01-01"
design:
  components:
    REDCARDS_SEMISTRUCTURED:
      position:
        x: 150
        "y": 80
      tempMetlId: 1
    Flatten MANCHESTERUNITED_SEMI:
      position:
        x: 310
        "y": 80
      tempMetlId: 2
    Yesterday's Date:
      position:
        x: 310
        "y": -10
      tempMetlId: 3
    Apply Data Freshness:
      position:
        x: 490
        "y": 80
      tempMetlId: 4
    Write to REDCARDS_STRUCTURED:
      position:
        x: 670
        "y": 80
      tempMetlId: 5
